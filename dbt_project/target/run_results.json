{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.8.7", "generated_at": "2024-11-03T20:47:49.339630Z", "invocation_id": "7197c6e1-08b7-4bdd-acfc-a3ab44159fe1", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-03T20:47:34.175820Z", "completed_at": "2024-11-03T20:47:34.184689Z"}, {"name": "execute", "started_at": "2024-11-03T20:47:34.185021Z", "completed_at": "2024-11-03T20:47:35.888537Z"}], "thread_id": "Thread-1", "execution_time": 1.7156100273132324, "adapter_response": {"_message": "OK", "query_id": "01ef9a24-da3c-1bec-a89d-68035721c189"}, "message": "OK", "failures": null, "unique_id": "model.business_accounts.staging_business_accounts", "compiled": true, "compiled_code": "\n\nwith business_accounts as (\n    select\n        account_id,\n        business_name as account_name,\n        contact_email,\n        to_date(registration_date, 'YYYY-MM-DD') as registration_date\n    from `hive_metastore`.`raw`.`raw_business_accounts`\n    where contact_email is not null\n)\n\nselect *\nfrom business_accounts;", "relation_name": "`hive_metastore`.`default`.`staging_business_accounts`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-03T20:47:35.892642Z", "completed_at": "2024-11-03T20:47:35.895570Z"}, {"name": "execute", "started_at": "2024-11-03T20:47:35.895937Z", "completed_at": "2024-11-03T20:47:37.331845Z"}], "thread_id": "Thread-3", "execution_time": 1.4414620399475098, "adapter_response": {"_message": "OK", "query_id": "01ef9a24-db76-106e-9eb9-1e318b8a2850"}, "message": "OK", "failures": null, "unique_id": "model.business_accounts.integrated_business_accounts", "compiled": true, "compiled_code": "\n\nwith deduplicated_accounts as (\n    select\n        account_id,\n        max(account_name) as account_name,\n        max(contact_email) as contact_email,\n        max(registration_date) as registration_date\n    from (\n        select\n            account_id,\n            account_name,\n            contact_email,\n            registration_date\n        from `hive_metastore`.`default`.`staging_business_accounts`\n    ) as accounts\n    group by account_id\n),\n\ntransactions_sum as (\n    select\n        account_id,\n        sum(transaction_amount) as total_transactions_amount\n    from `hive_metastore`.`raw`.`raw_transactions`\n    group by account_id\n)\n\nselect\n    a.account_id,\n    a.account_name,\n    a.contact_email,\n    a.registration_date,\n    coalesce(t.total_transactions_amount, 0) as total_transactions_amount\nfrom deduplicated_accounts a\nleft join transactions_sum t\n    on a.account_id = t.account_id\norder by a.registration_date desc;", "relation_name": "`hive_metastore`.`default`.`integrated_business_accounts`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-11-03T20:47:37.338850Z", "completed_at": "2024-11-03T20:47:37.346450Z"}, {"name": "execute", "started_at": "2024-11-03T20:47:37.346838Z", "completed_at": "2024-11-03T20:47:48.566050Z"}], "thread_id": "Thread-2", "execution_time": 11.230183124542236, "adapter_response": {"_message": "OK", "query_id": "01ef9a24-dcba-1344-95cb-755a5ca8ae88"}, "message": "OK", "failures": null, "unique_id": "model.business_accounts.prepared_business_accounts", "compiled": true, "compiled_code": "\n\nwith integrated_accounts as (\n    select\n        account_id,\n        account_name,\n        contact_email,\n        registration_date\n    from `hive_metastore`.`default`.`integrated_business_accounts`\n),\n\ntransaction_metrics as (\n    select\n        account_id,\n        count(transaction_id) as total_number_of_transactions,\n        \n    sum(transaction_amount)\n as total_transaction_volume,\n        min(transaction_date) as first_transaction_date,\n        max(transaction_date) as last_transaction_date\n    from `hive_metastore`.`raw`.`raw_transactions`\n    group by account_id\n),\n\naccount_aggregated_data as (\n    select\n        ia.account_id,\n        ia.account_name,\n        ia.contact_email,\n        ia.registration_date,\n        coalesce(tm.total_number_of_transactions, 0) as total_number_of_transactions,\n        coalesce(tm.total_transaction_volume, 0) as total_transaction_volume,\n        tm.first_transaction_date,\n        tm.last_transaction_date\n    from integrated_accounts ia\n    left join transaction_metrics tm on ia.account_id = tm.account_id\n)\n\nselect\n    account_id,\n    account_name,\n    contact_email,\n    registration_date,\n    total_number_of_transactions,\n    total_transaction_volume,\n    first_transaction_date,\n    last_transaction_date,\n    \n    CAST(current_timestamp() AS TIMESTAMP) as created_at,\n    CAST(current_timestamp() AS TIMESTAMP) as updated_at,\n    CAST(current_timestamp() AS TIMESTAMP) as processed_at\n\nfrom account_aggregated_data;", "relation_name": "`hive_metastore`.`default`.`prepared_business_accounts`"}], "elapsed_time": 26.175090789794922, "args": {"exclude": [], "populate_cache": true, "strict_mode": false, "write_json": true, "require_explicit_package_overrides_for_builtin_materializations": true, "partial_parse_file_diff": true, "invocation_command": "dbt run", "log_level_file": "debug", "defer": false, "print": true, "cache_selected_only": false, "project_dir": "/Users/ankurchopra/repo_projects/ai-codecraft/smart_code_generator/generated_code/dbt_project", "require_resource_names_without_spaces": false, "show_resource_report": false, "use_colors_file": true, "version_check": true, "log_path": "/Users/ankurchopra/repo_projects/ai-codecraft/smart_code_generator/generated_code/dbt_project/logs", "vars": {}, "printer_width": 80, "log_file_max_bytes": 10485760, "log_format_file": "debug", "indirect_selection": "eager", "empty": false, "enable_legacy_logger": false, "source_freshness_run_project_hooks": false, "which": "run", "log_format": "default", "send_anonymous_usage_stats": true, "introspect": true, "use_colors": true, "select": [], "profiles_dir": "/Users/ankurchopra/.dbt", "macro_debugging": false, "log_level": "info", "warn_error_options": {"include": [], "exclude": []}, "static_parser": true, "favor_state": false, "quiet": false, "partial_parse": true}}